{"ast":null,"code":"import _objectSpread from\"C:/Users/user/Documents/GitHub/BrightBuy-Frontend/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";/**\r\n * Checkout Page Component\r\n * Order checkout with billing and payment information\r\n */import React,{useState,useEffect}from'react';import{Link,useNavigate}from'react-router-dom';import axios from'axios';import{useAuth}from'../context/AuthContext';import Spinner from'../components/common/Spinner';import'./Checkout.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Checkout=()=>{const{isAuthenticated,user}=useAuth();const navigate=useNavigate();const[cartData,setCartData]=useState(null);const[loading,setLoading]=useState(true);const[processingOrder,setProcessingOrder]=useState(false);const[error,setError]=useState('');const[deliveryEstimate,setDeliveryEstimate]=useState(null);const[formData,setFormData]=useState({firstName:'',lastName:'',email:(user===null||user===void 0?void 0:user.email)||'',phone:'',houseNumber:'',street:'',city:'',state:'',paymentMethod:'card',deliveryMethod:'home_delivery',addressId:(user===null||user===void 0?void 0:user.address_id)||null});const[cities,setCities]=useState([]);// Fetch cart data and cities\nuseEffect(()=>{const fetchData=async()=>{if(!isAuthenticated||!user){setLoading(false);return;}try{setLoading(true);// Fetch cart\nconst cartResponse=await axios.get(\"http://127.0.0.1:8020/cart/\".concat(user.user_id));setCartData(cartResponse.data);// Fetch cities\nconst citiesResponse=await axios.get('http://127.0.0.1:8020/locations/cities');setCities(citiesResponse.data);}catch(err){console.error('Error fetching data:',err);setError('Failed to load data');}finally{setLoading(false);}};fetchData();},[isAuthenticated,user]);// Fetch delivery estimate when delivery method or city changes\nuseEffect(()=>{const fetchDeliveryEstimate=async()=>{if(!user||!formData.deliveryMethod)return;try{let url=\"http://127.0.0.1:8020/cart/delivery-estimate/\".concat(user.user_id,\"?delivery_method=\").concat(formData.deliveryMethod);if(formData.deliveryMethod==='home_delivery'&&formData.city){url+=\"&city=\".concat(encodeURIComponent(formData.city));}console.log('Fetching delivery estimate from:',url);const response=await axios.get(url);console.log('Delivery estimate response:',response.data);setDeliveryEstimate(response.data);}catch(err){console.error('Error fetching delivery estimate:',err);setDeliveryEstimate(null);}};fetchDeliveryEstimate();},[user,formData.deliveryMethod,formData.city]);const handleInputChange=e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{[e.target.name]:e.target.value}));};const handleSubmit=async e=>{e.preventDefault();if(!user){alert('Please login to place an order');return;}// Validate delivery method and address\nif(formData.deliveryMethod==='home_delivery'){if(!formData.addressId&&(!formData.houseNumber||!formData.street||!formData.city||!formData.state)){alert('Please fill in all address fields for home delivery');return;}}// Prepare order data\nconst orderData={user_id:user.user_id,payment_method:formData.paymentMethod,delivery_method:formData.deliveryMethod,address_id:null,address_details:null,total_amount:cartData.total_amount};// If home delivery, include address\nif(formData.deliveryMethod==='home_delivery'){if(formData.addressId){orderData.address_id=formData.addressId;}else{// Create new address\norderData.address_details={house_number:parseInt(formData.houseNumber),street:formData.street,city:formData.city,state:formData.state};}}// If card payment, navigate to payment page\nif(formData.paymentMethod==='card'){navigate('/payment',{state:{orderData}});return;}// For COD, process order directly\nsetProcessingOrder(true);try{const response=await axios.post('http://127.0.0.1:8020/orders/checkout',orderData);const order=response.data;console.log('Order created:',order);// Show success message\nconst deliveryMsg=formData.deliveryMethod==='home_delivery'?'Home Delivery':'Store Pickup';alert(\"Order #\".concat(order.order_id,\" placed successfully!\\nTotal: $\").concat(parseFloat(order.total_amount).toFixed(2),\"\\nPayment: Cash on Delivery\\nDelivery: \").concat(deliveryMsg));// Navigate to home page\nnavigate(\"/\");}catch(err){var _err$response,_err$response$data;console.error('Error creating order:',err);alert(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.detail)||'Failed to place order. Please try again.');}finally{setProcessingOrder(false);}};// Redirect if not logged in\nif(!isAuthenticated){return/*#__PURE__*/_jsx(\"div\",{className:\"checkout-page\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container py-5\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-lock fa-5x text-muted mb-4\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"Please Login to Checkout\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-4\",children:\"You need to be logged in to place an order.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/'),className:\"btn btn-primary rounded-pill py-3 px-5\",children:\"Go to Login\"})]})})});}if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"container py-5\",children:/*#__PURE__*/_jsx(Spinner,{})});}if(!cartData||!cartData.cart_items||cartData.cart_items.length===0){return/*#__PURE__*/_jsx(\"div\",{className:\"checkout-page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container py-5 text-center\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-shopping-cart fa-5x text-muted mb-4\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"Your cart is empty\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-4\",children:\"Add some products before checking out.\"}),/*#__PURE__*/_jsx(Link,{to:\"/shop\",className:\"btn btn-primary rounded-pill py-3 px-5\",children:\"Continue Shopping\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"container-fluid page-header py-5\",style:{backgroundImage:'url(/img/topbar.png)',backgroundSize:'cover',backgroundPosition:'center',backgroundRepeat:'no-repeat',position:'relative',minHeight:'260px'},children:[/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:0,left:0,right:0,bottom:0,backgroundColor:'rgba(0,0,0,0.45)',zIndex:1}}),/*#__PURE__*/_jsx(\"div\",{className:\"container text-center py-5\",style:{position:'relative',zIndex:2},children:/*#__PURE__*/_jsx(\"h1\",{className:\"display-4 text-white mb-3 fw-bolder\",children:\"Checkout\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"container-fluid py-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container py-5\",children:/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSubmit,children:/*#__PURE__*/_jsxs(\"div\",{className:\"row g-5\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-lg-8\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"mb-4\",children:\"Billing Details\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"row g-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"First Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",name:\"firstName\",value:formData.firstName,onChange:handleInputChange,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Last Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",name:\"lastName\",value:formData.lastName,onChange:handleInputChange,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Email *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",className:\"form-control\",name:\"email\",value:formData.email,onChange:handleInputChange,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Phone *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",className:\"form-control\",name:\"phone\",value:formData.phone,onChange:handleInputChange,required:true})]}),formData.deliveryMethod==='home_delivery'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"House Number *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"form-control\",name:\"houseNumber\",value:formData.houseNumber,onChange:handleInputChange,placeholder:\"e.g., 123\",required:formData.deliveryMethod==='home_delivery'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Street *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",name:\"street\",value:formData.street,onChange:handleInputChange,placeholder:\"e.g., Main Street\",required:formData.deliveryMethod==='home_delivery'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"City *\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"form-select\",name:\"city\",value:formData.city,onChange:handleInputChange,required:formData.deliveryMethod==='home_delivery',children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select City\"}),cities.map(city=>/*#__PURE__*/_jsxs(\"option\",{value:city.city,children:[city.city,\" \",city.Is_main_city?'(Main City)':'']},city.city_id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"State *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",name:\"state\",value:formData.state,onChange:handleInputChange,placeholder:\"e.g., California\",required:formData.deliveryMethod==='home_delivery'})]})]})]}),/*#__PURE__*/_jsx(\"h4\",{className:\"mt-5 mb-4\",children:\"Delivery Method\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"delivery-methods mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-check mb-3 p-3 border rounded\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"radio\",name:\"deliveryMethod\",id:\"home_delivery\",value:\"home_delivery\",checked:formData.deliveryMethod==='home_delivery',onChange:handleInputChange}),/*#__PURE__*/_jsxs(\"label\",{className:\"form-check-label\",htmlFor:\"home_delivery\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Home Delivery\"}),/*#__PURE__*/_jsx(\"br\",{}),formData.deliveryMethod==='home_delivery'&&deliveryEstimate&&deliveryEstimate.estimated_days!==null&&deliveryEstimate.estimated_days!==undefined?/*#__PURE__*/// Exact estimate when city is selected\n_jsxs(\"small\",{className:\"text-muted\",children:[/*#__PURE__*/_jsxs(\"strong\",{className:\"text-primary\",children:[\"Estimated: \",deliveryEstimate.estimated_days,\" days\"]}),deliveryEstimate.has_low_stock&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-warning ms-2\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-exclamation-triangle\"}),\" Low stock items\"]})]}):formData.deliveryMethod==='home_delivery'&&deliveryEstimate&&deliveryEstimate.main_city_estimate?/*#__PURE__*/// Range estimate when no city selected but we have stock info\n_jsxs(\"small\",{className:\"text-muted\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-primary\",children:[\"Main cities: \",deliveryEstimate.main_city_estimate,\" days\"]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-primary\",children:[\"Other cities: \",deliveryEstimate.other_city_estimate,\" days\"]}),deliveryEstimate.has_low_stock&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-warning d-block mt-1\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-exclamation-triangle\"}),\" Includes 3 extra days for low stock items\"]})]}):/*#__PURE__*/// Default message while loading\n_jsxs(\"small\",{className:\"text-muted\",children:[\"Main cities: 5 days\",/*#__PURE__*/_jsx(\"br\",{}),\"Other cities: 7 days\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-check p-3 border rounded\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"radio\",name:\"deliveryMethod\",id:\"store_pickup\",value:\"store_pickup\",checked:formData.deliveryMethod==='store_pickup',onChange:handleInputChange}),/*#__PURE__*/_jsxs(\"label\",{className:\"form-check-label\",htmlFor:\"store_pickup\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Store Pickup\"}),/*#__PURE__*/_jsx(\"br\",{}),formData.deliveryMethod==='store_pickup'&&deliveryEstimate&&deliveryEstimate.estimated_days!==null&&deliveryEstimate.estimated_days!==undefined?/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:/*#__PURE__*/_jsxs(\"strong\",{className:\"text-primary\",children:[\"Ready in \",deliveryEstimate.estimated_days,\" business days\"]})}):/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"Ready for pickup in 2 business days\"})]})]})]}),formData.deliveryMethod==='home_delivery'&&deliveryEstimate&&deliveryEstimate.estimated_days&&/*#__PURE__*/_jsxs(\"div\",{className:\"alert \".concat(deliveryEstimate.has_low_stock?'alert-warning':'alert-info'),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas \".concat(deliveryEstimate.has_low_stock?'fa-exclamation-triangle':'fa-info-circle',\" me-2\")}),deliveryEstimate.has_low_stock?/*#__PURE__*/_jsxs(_Fragment,{children:[\"Some items in your cart have low stock. Your order will be delivered in approximately \",/*#__PURE__*/_jsxs(\"strong\",{children:[deliveryEstimate.estimated_days,\" days\"]}),\" \",deliveryEstimate.is_main_city?'(main city)':'(other city)',\".\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[\"Your order will be delivered in approximately \",/*#__PURE__*/_jsxs(\"strong\",{children:[deliveryEstimate.estimated_days,\" days\"]}),\" \",deliveryEstimate.is_main_city?'(main city)':'(other city)',\".\"]})]}),formData.deliveryMethod==='home_delivery'&&!formData.city&&deliveryEstimate&&deliveryEstimate.has_low_stock!==undefined&&/*#__PURE__*/_jsxs(\"div\",{className:\"alert \".concat(deliveryEstimate.has_low_stock?'alert-warning':'alert-info'),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas \".concat(deliveryEstimate.has_low_stock?'fa-exclamation-triangle':'fa-info-circle',\" me-2\")}),deliveryEstimate.has_low_stock?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Low stock detected!\"}),\" Please select your city to see the exact delivery time. Expected: \",deliveryEstimate.main_city_estimate,\" days (main cities) or \",deliveryEstimate.other_city_estimate,\" days (other cities).\"]}):/*#__PURE__*/_jsx(_Fragment,{children:\"Please select your city to see the exact delivery time.\"})]}),/*#__PURE__*/_jsx(\"h4\",{className:\"mt-5 mb-4\",children:\"Payment Method\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"payment-methods\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-check mb-3 p-3 border rounded\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"radio\",name:\"paymentMethod\",id:\"card\",value:\"card\",checked:formData.paymentMethod==='card',onChange:handleInputChange}),/*#__PURE__*/_jsxs(\"label\",{className:\"form-check-label\",htmlFor:\"card\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Credit/Debit Card\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"Payment will be processed immediately\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-check p-3 border rounded\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"radio\",name:\"paymentMethod\",id:\"cod\",value:\"cod\",checked:formData.paymentMethod==='cod',onChange:handleInputChange}),/*#__PURE__*/_jsxs(\"label\",{className:\"form-check-label\",htmlFor:\"cod\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Cash on Delivery\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"Pay when you receive your order\"})]})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-light rounded p-4 sticky-top\",style:{top:'100px'},children:[/*#__PURE__*/_jsx(\"h4\",{className:\"mb-4\",children:\"Your Order\"}),/*#__PURE__*/_jsx(\"div\",{className:\"order-items\",style:{maxHeight:'300px',overflowY:'auto'},children:cartData.cart_items.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between mb-3 pb-3 border-bottom\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/img/Variants/\".concat(item.variant_id,\".jpg\"),alt:item.variant_name,style:{width:'50px',height:'50px',objectFit:'cover',backgroundColor:'#f8f9fa'},className:\"rounded me-3\",onError:e=>{// Try different image formats\nif(e.target.src.includes('.jpg')){e.target.src=\"/img/Variants/\".concat(item.variant_id,\".png\");}else if(e.target.src.includes('.png')){e.target.src=\"/img/Variants/\".concat(item.variant_id,\".jpeg\");}else if(e.target.src.includes('.jpeg')){e.target.src=\"/img/Variants/\".concat(item.variant_id,\".webp\");}else if(e.target.src.includes('.webp')){e.target.src=\"/img/Variants/\".concat(item.variant_id,\".avif\");}else{// Final fallback to product image\ne.target.src=\"/img/product-\".concat(item.product_id,\".png\");}}}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h6\",{className:\"mb-0\",style:{fontSize:'14px'},children:item.product_name}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:item.variant_name}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[\"Qty: \",item.quantity]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-end\",children:/*#__PURE__*/_jsxs(\"strong\",{children:[\"$\",(parseFloat(item.price)*item.quantity).toFixed(2)]})})]},item.cart_item_id))}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Subtotal:\"}),/*#__PURE__*/_jsxs(\"strong\",{children:[\"$\",parseFloat(cartData.total_amount||0).toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between mb-3\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Shipping:\"}),/*#__PURE__*/_jsx(\"strong\",{className:\"text-success\",children:\"Free\"})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between mb-4\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Total:\"}),/*#__PURE__*/_jsxs(\"h5\",{className:\"text-primary\",children:[\"$\",parseFloat(cartData.total_amount||0).toFixed(2)]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary w-100 rounded-pill py-3\",disabled:processingOrder,children:processingOrder?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-spinner fa-spin me-2\"}),\"Processing...\"]}):formData.paymentMethod==='card'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-credit-card me-2\"}),\"Proceed to Payment\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-check me-2\"}),\"Place Order\"]})}),/*#__PURE__*/_jsxs(Link,{to:\"/cart\",className:\"btn btn-outline-secondary w-100 rounded-pill py-2 mt-2\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-arrow-left me-2\"}),\"Back to Cart\"]})]})})]})})})})]});};export default Checkout;","map":{"version":3,"names":["React","useState","useEffect","Link","useNavigate","axios","useAuth","Spinner","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Checkout","isAuthenticated","user","navigate","cartData","setCartData","loading","setLoading","processingOrder","setProcessingOrder","error","setError","deliveryEstimate","setDeliveryEstimate","formData","setFormData","firstName","lastName","email","phone","houseNumber","street","city","state","paymentMethod","deliveryMethod","addressId","address_id","cities","setCities","fetchData","cartResponse","get","concat","user_id","data","citiesResponse","err","console","fetchDeliveryEstimate","url","encodeURIComponent","log","response","handleInputChange","e","_objectSpread","target","name","value","handleSubmit","preventDefault","alert","orderData","payment_method","delivery_method","address_details","total_amount","house_number","parseInt","post","order","deliveryMsg","order_id","parseFloat","toFixed","_err$response","_err$response$data","detail","className","children","onClick","cart_items","length","to","style","backgroundImage","backgroundSize","backgroundPosition","backgroundRepeat","position","minHeight","top","left","right","bottom","backgroundColor","zIndex","onSubmit","type","onChange","required","placeholder","map","Is_main_city","city_id","id","checked","htmlFor","estimated_days","undefined","has_low_stock","main_city_estimate","other_city_estimate","is_main_city","maxHeight","overflowY","item","src","variant_id","alt","variant_name","width","height","objectFit","onError","includes","product_id","fontSize","product_name","quantity","price","cart_item_id","disabled"],"sources":["C:/Users/user/Documents/GitHub/BrightBuy-Frontend/frontend/src/pages/Checkout.jsx"],"sourcesContent":["/**\r\n * Checkout Page Component\r\n * Order checkout with billing and payment information\r\n */\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport Spinner from '../components/common/Spinner';\r\nimport './Checkout.css';\r\n\r\nconst Checkout = () => {\r\n  const { isAuthenticated, user } = useAuth();\r\n  const navigate = useNavigate();\r\n  \r\n  const [cartData, setCartData] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [processingOrder, setProcessingOrder] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [deliveryEstimate, setDeliveryEstimate] = useState(null);\r\n  \r\n  const [formData, setFormData] = useState({\r\n    firstName: '',\r\n    lastName: '',\r\n    email: user?.email || '',\r\n    phone: '',\r\n    houseNumber: '',\r\n    street: '',\r\n    city: '',\r\n    state: '',\r\n    paymentMethod: 'card',\r\n    deliveryMethod: 'home_delivery',\r\n    addressId: user?.address_id || null\r\n  });\r\n\r\n  const [cities, setCities] = useState([]);\r\n\r\n  // Fetch cart data and cities\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      if (!isAuthenticated || !user) {\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        setLoading(true);\r\n        \r\n        // Fetch cart\r\n        const cartResponse = await axios.get(`http://127.0.0.1:8020/cart/${user.user_id}`);\r\n        setCartData(cartResponse.data);\r\n        \r\n        // Fetch cities\r\n        const citiesResponse = await axios.get('http://127.0.0.1:8020/locations/cities');\r\n        setCities(citiesResponse.data);\r\n      } catch (err) {\r\n        console.error('Error fetching data:', err);\r\n        setError('Failed to load data');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, [isAuthenticated, user]);\r\n\r\n  // Fetch delivery estimate when delivery method or city changes\r\n  useEffect(() => {\r\n    const fetchDeliveryEstimate = async () => {\r\n      if (!user || !formData.deliveryMethod) return;\r\n\r\n      try {\r\n        let url = `http://127.0.0.1:8020/cart/delivery-estimate/${user.user_id}?delivery_method=${formData.deliveryMethod}`;\r\n        \r\n        if (formData.deliveryMethod === 'home_delivery' && formData.city) {\r\n          url += `&city=${encodeURIComponent(formData.city)}`;\r\n        }\r\n\r\n        console.log('Fetching delivery estimate from:', url);\r\n        const response = await axios.get(url);\r\n        console.log('Delivery estimate response:', response.data);\r\n        setDeliveryEstimate(response.data);\r\n      } catch (err) {\r\n        console.error('Error fetching delivery estimate:', err);\r\n        setDeliveryEstimate(null);\r\n      }\r\n    };\r\n\r\n    fetchDeliveryEstimate();\r\n  }, [user, formData.deliveryMethod, formData.city]);\r\n\r\n  const handleInputChange = (e) => {\r\n    setFormData({\r\n      ...formData,\r\n      [e.target.name]: e.target.value\r\n    });\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    if (!user) {\r\n      alert('Please login to place an order');\r\n      return;\r\n    }\r\n\r\n    // Validate delivery method and address\r\n    if (formData.deliveryMethod === 'home_delivery') {\r\n      if (!formData.addressId && (!formData.houseNumber || !formData.street || !formData.city || !formData.state)) {\r\n        alert('Please fill in all address fields for home delivery');\r\n        return;\r\n      }\r\n    }\r\n\r\n    // Prepare order data\r\n    const orderData = {\r\n      user_id: user.user_id,\r\n      payment_method: formData.paymentMethod,\r\n      delivery_method: formData.deliveryMethod,\r\n      address_id: null,\r\n      address_details: null,\r\n      total_amount: cartData.total_amount\r\n    };\r\n\r\n    // If home delivery, include address\r\n    if (formData.deliveryMethod === 'home_delivery') {\r\n      if (formData.addressId) {\r\n        orderData.address_id = formData.addressId;\r\n      } else {\r\n        // Create new address\r\n        orderData.address_details = {\r\n          house_number: parseInt(formData.houseNumber),\r\n          street: formData.street,\r\n          city: formData.city,\r\n          state: formData.state\r\n        };\r\n      }\r\n    }\r\n\r\n    // If card payment, navigate to payment page\r\n    if (formData.paymentMethod === 'card') {\r\n      navigate('/payment', { state: { orderData } });\r\n      return;\r\n    }\r\n\r\n    // For COD, process order directly\r\n    setProcessingOrder(true);\r\n    try {\r\n      const response = await axios.post('http://127.0.0.1:8020/orders/checkout', orderData);\r\n\r\n      const order = response.data;\r\n      console.log('Order created:', order);\r\n\r\n      // Show success message\r\n      const deliveryMsg = formData.deliveryMethod === 'home_delivery' ? 'Home Delivery' : 'Store Pickup';\r\n      \r\n      alert(`Order #${order.order_id} placed successfully!\\nTotal: $${parseFloat(order.total_amount).toFixed(2)}\\nPayment: Cash on Delivery\\nDelivery: ${deliveryMsg}`);\r\n      \r\n      // Navigate to home page\r\n      navigate(`/`);\r\n      \r\n    } catch (err) {\r\n      console.error('Error creating order:', err);\r\n      alert(err.response?.data?.detail || 'Failed to place order. Please try again.');\r\n    } finally {\r\n      setProcessingOrder(false);\r\n    }\r\n  };\r\n\r\n  // Redirect if not logged in\r\n  if (!isAuthenticated) {\r\n    return (\r\n      <div className=\"checkout-page\">\r\n        <div className=\"container py-5\">\r\n          <div className=\"text-center\">\r\n            <i className=\"fas fa-lock fa-5x text-muted mb-4\"></i>\r\n            <h3>Please Login to Checkout</h3>\r\n            <p className=\"text-muted mb-4\">You need to be logged in to place an order.</p>\r\n            <button onClick={() => navigate('/')} className=\"btn btn-primary rounded-pill py-3 px-5\">\r\n              Go to Login\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"container py-5\">\r\n        <Spinner />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!cartData || !cartData.cart_items || cartData.cart_items.length === 0) {\r\n    return (\r\n      <div className=\"checkout-page\">\r\n        <div className=\"container py-5 text-center\">\r\n          <i className=\"fas fa-shopping-cart fa-5x text-muted mb-4\"></i>\r\n          <h3>Your cart is empty</h3>\r\n          <p className=\"text-muted mb-4\">Add some products before checking out.</p>\r\n          <Link to=\"/shop\" className=\"btn btn-primary rounded-pill py-3 px-5\">\r\n            Continue Shopping\r\n          </Link>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"checkout-page\">\r\n      <div className=\"container-fluid page-header py-5\" style={{\r\n        backgroundImage: 'url(/img/topbar.png)',\r\n        backgroundSize: 'cover',\r\n        backgroundPosition: 'center',\r\n        backgroundRepeat: 'no-repeat',\r\n        position: 'relative',\r\n        minHeight: '260px'\r\n      }}>\r\n        <div style={{\r\n          position: 'absolute',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          backgroundColor: 'rgba(0,0,0,0.45)',\r\n          zIndex: 1\r\n        }}></div>\r\n        <div className=\"container text-center py-5\" style={{ position: 'relative', zIndex: 2 }}>\r\n          <h1 className=\"display-4 text-white mb-3 fw-bolder\">Checkout</h1>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"container-fluid py-5\">\r\n        <div className=\"container py-5\">\r\n          <form onSubmit={handleSubmit}>\r\n            <div className=\"row g-5\">\r\n              {/* Billing Details */}\r\n              <div className=\"col-lg-8\">\r\n                <h4 className=\"mb-4\">Billing Details</h4>\r\n                <div className=\"row g-3\">\r\n                  <div className=\"col-md-6\">\r\n                    <label className=\"form-label\">First Name *</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      className=\"form-control\"\r\n                      name=\"firstName\"\r\n                      value={formData.firstName}\r\n                      onChange={handleInputChange}\r\n                      required\r\n                    />\r\n                  </div>\r\n                  <div className=\"col-md-6\">\r\n                    <label className=\"form-label\">Last Name *</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      className=\"form-control\"\r\n                      name=\"lastName\"\r\n                      value={formData.lastName}\r\n                      onChange={handleInputChange}\r\n                      required\r\n                    />\r\n                  </div>\r\n                  <div className=\"col-md-6\">\r\n                    <label className=\"form-label\">Email *</label>\r\n                    <input\r\n                      type=\"email\"\r\n                      className=\"form-control\"\r\n                      name=\"email\"\r\n                      value={formData.email}\r\n                      onChange={handleInputChange}\r\n                      required\r\n                    />\r\n                  </div>\r\n                  <div className=\"col-md-6\">\r\n                    <label className=\"form-label\">Phone *</label>\r\n                    <input\r\n                      type=\"tel\"\r\n                      className=\"form-control\"\r\n                      name=\"phone\"\r\n                      value={formData.phone}\r\n                      onChange={handleInputChange}\r\n                      required\r\n                    />\r\n                  </div>\r\n                  {formData.deliveryMethod === 'home_delivery' && (\r\n                    <>\r\n                      <div className=\"col-md-6\">\r\n                        <label className=\"form-label\">House Number *</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          className=\"form-control\"\r\n                          name=\"houseNumber\"\r\n                          value={formData.houseNumber}\r\n                          onChange={handleInputChange}\r\n                          placeholder=\"e.g., 123\"\r\n                          required={formData.deliveryMethod === 'home_delivery'}\r\n                        />\r\n                      </div>\r\n                      <div className=\"col-md-6\">\r\n                        <label className=\"form-label\">Street *</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          className=\"form-control\"\r\n                          name=\"street\"\r\n                          value={formData.street}\r\n                          onChange={handleInputChange}\r\n                          placeholder=\"e.g., Main Street\"\r\n                          required={formData.deliveryMethod === 'home_delivery'}\r\n                        />\r\n                      </div>\r\n                      <div className=\"col-md-6\">\r\n                        <label className=\"form-label\">City *</label>\r\n                        <select\r\n                          className=\"form-select\"\r\n                          name=\"city\"\r\n                          value={formData.city}\r\n                          onChange={handleInputChange}\r\n                          required={formData.deliveryMethod === 'home_delivery'}\r\n                        >\r\n                          <option value=\"\">Select City</option>\r\n                          {cities.map((city) => (\r\n                            <option key={city.city_id} value={city.city}>\r\n                              {city.city} {city.Is_main_city ? '(Main City)' : ''}\r\n                            </option>\r\n                          ))}\r\n                        </select>\r\n                      </div>\r\n                      <div className=\"col-md-6\">\r\n                        <label className=\"form-label\">State *</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          className=\"form-control\"\r\n                          name=\"state\"\r\n                          value={formData.state}\r\n                          onChange={handleInputChange}\r\n                          placeholder=\"e.g., California\"\r\n                          required={formData.deliveryMethod === 'home_delivery'}\r\n                        />\r\n                      </div>\r\n                    </>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Delivery Method */}\r\n                <h4 className=\"mt-5 mb-4\">Delivery Method</h4>\r\n                <div className=\"delivery-methods mb-4\">\r\n                  <div className=\"form-check mb-3 p-3 border rounded\">\r\n                    <input\r\n                      className=\"form-check-input\"\r\n                      type=\"radio\"\r\n                      name=\"deliveryMethod\"\r\n                      id=\"home_delivery\"\r\n                      value=\"home_delivery\"\r\n                      checked={formData.deliveryMethod === 'home_delivery'}\r\n                      onChange={handleInputChange}\r\n                    />\r\n                    <label className=\"form-check-label\" htmlFor=\"home_delivery\">\r\n                      <strong>Home Delivery</strong>\r\n                      <br />\r\n                      {formData.deliveryMethod === 'home_delivery' && deliveryEstimate && deliveryEstimate.estimated_days !== null && deliveryEstimate.estimated_days !== undefined ? (\r\n                        // Exact estimate when city is selected\r\n                        <small className=\"text-muted\">\r\n                          <strong className=\"text-primary\">Estimated: {deliveryEstimate.estimated_days} days</strong>\r\n                          {deliveryEstimate.has_low_stock && (\r\n                            <span className=\"text-warning ms-2\">\r\n                              <i className=\"fas fa-exclamation-triangle\"></i> Low stock items\r\n                            </span>\r\n                          )}\r\n                        </small>\r\n                      ) : formData.deliveryMethod === 'home_delivery' && deliveryEstimate && deliveryEstimate.main_city_estimate ? (\r\n                        // Range estimate when no city selected but we have stock info\r\n                        <small className=\"text-muted\">\r\n                          <span className=\"text-primary\">Main cities: {deliveryEstimate.main_city_estimate} days</span>\r\n                          <br />\r\n                          <span className=\"text-primary\">Other cities: {deliveryEstimate.other_city_estimate} days</span>\r\n                          {deliveryEstimate.has_low_stock && (\r\n                            <span className=\"text-warning d-block mt-1\">\r\n                              <i className=\"fas fa-exclamation-triangle\"></i> Includes 3 extra days for low stock items\r\n                            </span>\r\n                          )}\r\n                        </small>\r\n                      ) : (\r\n                        // Default message while loading\r\n                        <small className=\"text-muted\">\r\n                          Main cities: 5 days<br />\r\n                          Other cities: 7 days\r\n                        </small>\r\n                      )}\r\n                    </label>\r\n                  </div>\r\n                  <div className=\"form-check p-3 border rounded\">\r\n                    <input\r\n                      className=\"form-check-input\"\r\n                      type=\"radio\"\r\n                      name=\"deliveryMethod\"\r\n                      id=\"store_pickup\"\r\n                      value=\"store_pickup\"\r\n                      checked={formData.deliveryMethod === 'store_pickup'}\r\n                      onChange={handleInputChange}\r\n                    />\r\n                    <label className=\"form-check-label\" htmlFor=\"store_pickup\">\r\n                      <strong>Store Pickup</strong>\r\n                      <br />\r\n                      {formData.deliveryMethod === 'store_pickup' && deliveryEstimate && deliveryEstimate.estimated_days !== null && deliveryEstimate.estimated_days !== undefined ? (\r\n                        <small className=\"text-muted\">\r\n                          <strong className=\"text-primary\">Ready in {deliveryEstimate.estimated_days} business days</strong>\r\n                        </small>\r\n                      ) : (\r\n                        <small className=\"text-muted\">Ready for pickup in 2 business days</small>\r\n                      )}\r\n                    </label>\r\n                  </div>\r\n                </div>\r\n\r\n                {formData.deliveryMethod === 'home_delivery' && deliveryEstimate && deliveryEstimate.estimated_days && (\r\n                  <div className={`alert ${deliveryEstimate.has_low_stock ? 'alert-warning' : 'alert-info'}`}>\r\n                    <i className={`fas ${deliveryEstimate.has_low_stock ? 'fa-exclamation-triangle' : 'fa-info-circle'} me-2`}></i>\r\n                    {deliveryEstimate.has_low_stock ? (\r\n                      <>\r\n                        Some items in your cart have low stock. Your order will be delivered in approximately <strong>{deliveryEstimate.estimated_days} days</strong> {deliveryEstimate.is_main_city ? '(main city)' : '(other city)'}.\r\n                      </>\r\n                    ) : (\r\n                      <>\r\n                        Your order will be delivered in approximately <strong>{deliveryEstimate.estimated_days} days</strong> {deliveryEstimate.is_main_city ? '(main city)' : '(other city)'}.\r\n                      </>\r\n                    )}\r\n                  </div>\r\n                )}\r\n                \r\n                {formData.deliveryMethod === 'home_delivery' && !formData.city && deliveryEstimate && deliveryEstimate.has_low_stock !== undefined && (\r\n                  <div className={`alert ${deliveryEstimate.has_low_stock ? 'alert-warning' : 'alert-info'}`}>\r\n                    <i className={`fas ${deliveryEstimate.has_low_stock ? 'fa-exclamation-triangle' : 'fa-info-circle'} me-2`}></i>\r\n                    {deliveryEstimate.has_low_stock ? (\r\n                      <>\r\n                        <strong>Low stock detected!</strong> Please select your city to see the exact delivery time.\r\n                        Expected: {deliveryEstimate.main_city_estimate} days (main cities) or {deliveryEstimate.other_city_estimate} days (other cities).\r\n                      </>\r\n                    ) : (\r\n                      <>\r\n                        Please select your city to see the exact delivery time.\r\n                      </>\r\n                    )}\r\n                  </div>\r\n                )}\r\n\r\n                {/* Payment Method */}\r\n                <h4 className=\"mt-5 mb-4\">Payment Method</h4>\r\n                <div className=\"payment-methods\">\r\n                  <div className=\"form-check mb-3 p-3 border rounded\">\r\n                    <input\r\n                      className=\"form-check-input\"\r\n                      type=\"radio\"\r\n                      name=\"paymentMethod\"\r\n                      id=\"card\"\r\n                      value=\"card\"\r\n                      checked={formData.paymentMethod === 'card'}\r\n                      onChange={handleInputChange}\r\n                    />\r\n                    <label className=\"form-check-label\" htmlFor=\"card\">\r\n                      <strong>Credit/Debit Card</strong>\r\n                      <br />\r\n                      <small className=\"text-muted\">Payment will be processed immediately</small>\r\n                    </label>\r\n                  </div>\r\n                  <div className=\"form-check p-3 border rounded\">\r\n                    <input\r\n                      className=\"form-check-input\"\r\n                      type=\"radio\"\r\n                      name=\"paymentMethod\"\r\n                      id=\"cod\"\r\n                      value=\"cod\"\r\n                      checked={formData.paymentMethod === 'cod'}\r\n                      onChange={handleInputChange}\r\n                    />\r\n                    <label className=\"form-check-label\" htmlFor=\"cod\">\r\n                      <strong>Cash on Delivery</strong>\r\n                      <br />\r\n                      <small className=\"text-muted\">Pay when you receive your order</small>\r\n                    </label>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Order Summary */}\r\n              <div className=\"col-lg-4\">\r\n                <div className=\"bg-light rounded p-4 sticky-top\" style={{ top: '100px' }}>\r\n                  <h4 className=\"mb-4\">Your Order</h4>\r\n                  <div className=\"order-items\" style={{ maxHeight: '300px', overflowY: 'auto' }}>\r\n                    {cartData.cart_items.map((item) => (\r\n                      <div key={item.cart_item_id} className=\"d-flex justify-content-between mb-3 pb-3 border-bottom\">\r\n                        <div className=\"d-flex align-items-center\">\r\n                          <img\r\n                            src={`/img/Variants/${item.variant_id}.jpg`}\r\n                            alt={item.variant_name}\r\n                            style={{ width: '50px', height: '50px', objectFit: 'cover', backgroundColor: '#f8f9fa' }}\r\n                            className=\"rounded me-3\"\r\n                            onError={(e) => {\r\n                              // Try different image formats\r\n                              if (e.target.src.includes('.jpg')) {\r\n                                e.target.src = `/img/Variants/${item.variant_id}.png`;\r\n                              } else if (e.target.src.includes('.png')) {\r\n                                e.target.src = `/img/Variants/${item.variant_id}.jpeg`;\r\n                              } else if (e.target.src.includes('.jpeg')) {\r\n                                e.target.src = `/img/Variants/${item.variant_id}.webp`;\r\n                              } else if (e.target.src.includes('.webp')) {\r\n                                e.target.src = `/img/Variants/${item.variant_id}.avif`;\r\n                              } else {\r\n                                // Final fallback to product image\r\n                                e.target.src = `/img/product-${item.product_id}.png`;\r\n                              }\r\n                            }}\r\n                          />\r\n                          <div>\r\n                            <h6 className=\"mb-0\" style={{ fontSize: '14px' }}>{item.product_name}</h6>\r\n                            <small className=\"text-muted\">{item.variant_name}</small>\r\n                            <br />\r\n                            <small className=\"text-muted\">Qty: {item.quantity}</small>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"text-end\">\r\n                          <strong>${(parseFloat(item.price) * item.quantity).toFixed(2)}</strong>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                  <hr />\r\n                  <div className=\"d-flex justify-content-between mb-2\">\r\n                    <span>Subtotal:</span>\r\n                    <strong>${parseFloat(cartData.total_amount || 0).toFixed(2)}</strong>\r\n                  </div>\r\n                  <div className=\"d-flex justify-content-between mb-3\">\r\n                    <span>Shipping:</span>\r\n                    <strong className=\"text-success\">Free</strong>\r\n                  </div>\r\n                  <hr />\r\n                  <div className=\"d-flex justify-content-between mb-4\">\r\n                    <h5>Total:</h5>\r\n                    <h5 className=\"text-primary\">${parseFloat(cartData.total_amount || 0).toFixed(2)}</h5>\r\n                  </div>\r\n                  <button \r\n                    type=\"submit\" \r\n                    className=\"btn btn-primary w-100 rounded-pill py-3\"\r\n                    disabled={processingOrder}\r\n                  >\r\n                    {processingOrder ? (\r\n                      <>\r\n                        <i className=\"fas fa-spinner fa-spin me-2\"></i>\r\n                        Processing...\r\n                      </>\r\n                    ) : formData.paymentMethod === 'card' ? (\r\n                      <>\r\n                        <i className=\"fas fa-credit-card me-2\"></i>\r\n                        Proceed to Payment\r\n                      </>\r\n                    ) : (\r\n                      <>\r\n                        <i className=\"fas fa-check me-2\"></i>\r\n                        Place Order\r\n                      </>\r\n                    )}\r\n                  </button>\r\n                  <Link to=\"/cart\" className=\"btn btn-outline-secondary w-100 rounded-pill py-2 mt-2\">\r\n                    <i className=\"fas fa-arrow-left me-2\"></i>\r\n                    Back to Cart\r\n                  </Link>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Checkout;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}