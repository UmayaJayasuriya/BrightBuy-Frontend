{"ast":null,"code":"/**\r\n * ProductCard Component\r\n * Reusable product card for displaying product information\r\n */import React,{useState,useEffect}from'react';import{Link,useNavigate}from'react-router-dom';import{useCart}from'../../context/CartContext';import{useAuth}from'../../context/AuthContext';import axios from'axios';import'./ProductCard.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProductCard=_ref=>{let{product}=_ref;const{addToWishlist}=useCart();const{isAdmin,isAuthenticated,user,openLoginModal}=useAuth();const navigate=useNavigate();const[isFavorite,setIsFavorite]=useState(false);const[favLoading,setFavLoading]=useState(false);// Check if product is in favorites on mount\nuseEffect(()=>{const checkFavoriteStatus=async()=>{if(isAuthenticated&&user){try{const response=await axios.get(\"http://127.0.0.1:8020/favorites/check/\".concat(user.user_id,\"/\").concat(product.product_id));setIsFavorite(response.data.is_favorite);}catch(error){console.error('Error checking favorite status:',error);}}};checkFavoriteStatus();},[isAuthenticated,user,product.product_id]);const handleViewProduct=e=>{e.preventDefault();navigate(\"/single/\".concat(product.product_id));};const handleAddToFavorite=async e=>{e.preventDefault();// Check if user is logged in\nif(!isAuthenticated){// Directly open login modal\nopenLoginModal();return;}setFavLoading(true);try{if(isFavorite){// Remove from favorites\nawait axios.delete(\"http://127.0.0.1:8020/favorites/\".concat(user.user_id,\"/\").concat(product.product_id));setIsFavorite(false);// small inline feedback instead of blocking alert\nconsole.info('Removed from favorites');}else{// Add to favorites\nawait axios.post(\"http://127.0.0.1:8020/favorites/\".concat(user.user_id),{product_id:product.product_id});setIsFavorite(true);console.info('Added to favorites');}// Also update local wishlist for backward compatibility\naddToWishlist(product);}catch(error){var _error$response,_error$response$data,_error$response2,_error$response2$data;// Prefer server-provided error message when available\nconst serverMessage=(error===null||error===void 0?void 0:(_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.detail)||(error===null||error===void 0?void 0:(_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message);console.error('Error updating favorites:',error,serverMessage||'no server message');// show short alert to user\nalert(serverMessage?\"Failed to update favorites: \".concat(serverMessage):'Failed to update favorites. Please try again.');}finally{setFavLoading(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"product-card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"product-item border h-100\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"position-relative\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/img/products/\".concat(product.product_id,\".png\"),className:\"img-fluid w-100\",alt:product.product_name,style:{height:'250px',objectFit:'cover',backgroundColor:'#f8f9fa'},onError:e=>{// Fallback to .jpg if .png doesn't exist\nif(e.target.src.endsWith('.png')){e.target.src=\"/img/products/\".concat(product.product_id,\".jpg\");}else if(e.target.src.endsWith('.jpg')){// Fallback to placeholder if neither exists\ne.target.src='/img/product-1.png';}}}),/*#__PURE__*/_jsx(\"div\",{className:\"product-overlay\",children:/*#__PURE__*/_jsx(Link,{to:\"/single/\".concat(product.product_id),className:\"btn btn-sm btn-primary rounded-circle\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-eye\"})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-content p-4\",children:[product.category&&/*#__PURE__*/_jsx(Link,{to:\"/shop?category=\".concat(encodeURIComponent(product.category.category_name)),className:\"d-block mb-2 text-muted small\",children:product.category.category_name}),/*#__PURE__*/_jsx(Link,{to:\"/single/\".concat(product.product_id),className:\"h6 d-block mb-3 text-dark\",children:product.product_name}),product.description&&/*#__PURE__*/_jsx(\"p\",{className:\"text-muted small mb-3\",style:{overflow:'hidden',textOverflow:'ellipsis',display:'-webkit-box',WebkitLineClamp:2,WebkitBoxOrient:'vertical',minHeight:'40px'},children:product.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex gap-2 mt-3\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:handleViewProduct,className:\"btn btn-primary rounded-pill flex-grow-1\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas \".concat(isAdmin?'fa-edit':'fa-eye',\" me-2\")}),isAdmin?'Edit Product':'View Product']}),/*#__PURE__*/_jsx(\"button\",{onClick:handleAddToFavorite,className:\"btn \".concat(isFavorite?'btn-danger':'btn-outline-primary',\" rounded-circle\"),title:isFavorite?'Remove from Favorites':'Add to Favorites',disabled:favLoading,children:/*#__PURE__*/_jsx(\"i\",{className:\"fa\".concat(isFavorite?'s':'r',\" fa-heart\")})})]})]})]})});};export default ProductCard;","map":{"version":3,"names":["React","useState","useEffect","Link","useNavigate","useCart","useAuth","axios","jsx","_jsx","jsxs","_jsxs","ProductCard","_ref","product","addToWishlist","isAdmin","isAuthenticated","user","openLoginModal","navigate","isFavorite","setIsFavorite","favLoading","setFavLoading","checkFavoriteStatus","response","get","concat","user_id","product_id","data","is_favorite","error","console","handleViewProduct","e","preventDefault","handleAddToFavorite","delete","info","post","_error$response","_error$response$data","_error$response2","_error$response2$data","serverMessage","detail","message","alert","className","children","src","alt","product_name","style","height","objectFit","backgroundColor","onError","target","endsWith","to","category","encodeURIComponent","category_name","description","overflow","textOverflow","display","WebkitLineClamp","WebkitBoxOrient","minHeight","onClick","title","disabled"],"sources":["C:/Users/user/Documents/GitHub/BrightBuy-Frontend/frontend/src/components/common/ProductCard.jsx"],"sourcesContent":["/**\r\n * ProductCard Component\r\n * Reusable product card for displaying product information\r\n */\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { useCart } from '../../context/CartContext';\r\nimport { useAuth } from '../../context/AuthContext';\r\nimport axios from 'axios';\r\nimport './ProductCard.css';\r\n\r\nconst ProductCard = ({ product }) => {\r\n  const { addToWishlist } = useCart();\r\n  const { isAdmin, isAuthenticated, user, openLoginModal } = useAuth();\r\n  const navigate = useNavigate();\r\n  const [isFavorite, setIsFavorite] = useState(false);\r\n  const [favLoading, setFavLoading] = useState(false);\r\n\r\n  // Check if product is in favorites on mount\r\n  useEffect(() => {\r\n    const checkFavoriteStatus = async () => {\r\n      if (isAuthenticated && user) {\r\n        try {\r\n          const response = await axios.get(\r\n            `http://127.0.0.1:8020/favorites/check/${user.user_id}/${product.product_id}`\r\n          );\r\n          setIsFavorite(response.data.is_favorite);\r\n        } catch (error) {\r\n          console.error('Error checking favorite status:', error);\r\n        }\r\n      }\r\n    };\r\n\r\n    checkFavoriteStatus();\r\n  }, [isAuthenticated, user, product.product_id]);\r\n\r\n  const handleViewProduct = (e) => {\r\n    e.preventDefault();\r\n    navigate(`/single/${product.product_id}`);\r\n  };\r\n\r\n  const handleAddToFavorite = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    // Check if user is logged in\r\n    if (!isAuthenticated) {\r\n      // Directly open login modal\r\n      openLoginModal();\r\n      return;\r\n    }\r\n\r\n    setFavLoading(true);\r\n    try {\r\n      if (isFavorite) {\r\n        // Remove from favorites\r\n        await axios.delete(`http://127.0.0.1:8020/favorites/${user.user_id}/${product.product_id}`);\r\n        setIsFavorite(false);\r\n        // small inline feedback instead of blocking alert\r\n        console.info('Removed from favorites');\r\n      } else {\r\n        // Add to favorites\r\n        await axios.post(`http://127.0.0.1:8020/favorites/${user.user_id}`, {\r\n          product_id: product.product_id\r\n        });\r\n        setIsFavorite(true);\r\n        console.info('Added to favorites');\r\n      }\r\n\r\n      // Also update local wishlist for backward compatibility\r\n      addToWishlist(product);\r\n    } catch (error) {\r\n      // Prefer server-provided error message when available\r\n      const serverMessage = error?.response?.data?.detail || error?.response?.data?.message;\r\n      console.error('Error updating favorites:', error, serverMessage || 'no server message');\r\n      // show short alert to user\r\n      alert(serverMessage ? `Failed to update favorites: ${serverMessage}` : 'Failed to update favorites. Please try again.');\r\n    } finally {\r\n      setFavLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"product-card\">\r\n      <div className=\"product-item border h-100\">\r\n        <div className=\"position-relative\">\r\n          <img\r\n            src={`/img/products/${product.product_id}.png`}\r\n            className=\"img-fluid w-100\"\r\n            alt={product.product_name}\r\n            style={{ height: '250px', objectFit: 'cover', backgroundColor: '#f8f9fa' }}\r\n            onError={(e) => {\r\n              // Fallback to .jpg if .png doesn't exist\r\n              if (e.target.src.endsWith('.png')) {\r\n                e.target.src = `/img/products/${product.product_id}.jpg`;\r\n              } else if (e.target.src.endsWith('.jpg')) {\r\n                // Fallback to placeholder if neither exists\r\n                e.target.src = '/img/product-1.png';\r\n              }\r\n            }}\r\n          />\r\n          <div className=\"product-overlay\">\r\n            <Link\r\n              to={`/single/${product.product_id}`}\r\n              className=\"btn btn-sm btn-primary rounded-circle\"\r\n            >\r\n              <i className=\"fa fa-eye\"></i>\r\n            </Link>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"product-content p-4\">\r\n          {product.category && (\r\n            <Link to={`/shop?category=${encodeURIComponent(product.category.category_name)}`} className=\"d-block mb-2 text-muted small\">\r\n              {product.category.category_name}\r\n            </Link>\r\n          )}\r\n          <Link to={`/single/${product.product_id}`} className=\"h6 d-block mb-3 text-dark\">\r\n            {product.product_name}\r\n          </Link>\r\n\r\n          {product.description && (\r\n            <p className=\"text-muted small mb-3\" style={{ \r\n              overflow: 'hidden', \r\n              textOverflow: 'ellipsis', \r\n              display: '-webkit-box', \r\n              WebkitLineClamp: 2, \r\n              WebkitBoxOrient: 'vertical',\r\n              minHeight: '40px'\r\n            }}>\r\n              {product.description}\r\n            </p>\r\n          )}\r\n\r\n          <div className=\"d-flex gap-2 mt-3\">\r\n            <button\r\n              onClick={handleViewProduct}\r\n              className=\"btn btn-primary rounded-pill flex-grow-1\"\r\n            >\r\n              <i className={`fas ${isAdmin ? 'fa-edit' : 'fa-eye'} me-2`}></i>\r\n              {isAdmin ? 'Edit Product' : 'View Product'}\r\n            </button>\r\n            <button\r\n              onClick={handleAddToFavorite}\r\n              className={`btn ${isFavorite ? 'btn-danger' : 'btn-outline-primary'} rounded-circle`}\r\n              title={isFavorite ? 'Remove from Favorites' : 'Add to Favorites'}\r\n              disabled={favLoading}\r\n            >\r\n              <i className={`fa${isFavorite ? 's' : 'r'} fa-heart`}></i>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProductCard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}